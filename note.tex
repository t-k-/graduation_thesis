\documentclass[]{article}
\usepackage{xeCJK}
\setCJKmainfont{WenQuanYi Zen Hei Sharp}
\usepackage{amsmath} %可以使用align
\usepackage[top=0.95in,bottom=0.95in,left=1.35in,right=1.3in]{geometry} %页边距

\begin{document}

\begin{titlepage}
\begin{center}
\ %一个空格以后再用vfill才有效果
\vfill
\LARGE 毕业设计理论笔记\\
[1.5cm]
\large{钟\ 威}
\vfill
\large 最后更改时间：\today \\
\end{center}
\end{titlepage}

\section*{凸规划问题基础}
\subsection*{$P_{17}$ 定义 1.2.1}
称S是凸集，如果对于任意的$x_1,x_2 \in S$和任意的$\lambda \in [0,1]$,都有：
$$ 
{\lambda}x_1 + (1 - {\lambda})x_2 \in S 
\eqno{(1.2.1)} $$

\subsection*{$P_{17}$ 定义 1.2.3}
任意的$ x_1,x_2 \in S $和任意的$ \lambda \in (0,1)$,都有：
$$ 
f({\lambda}x_1 + (1 - \lambda)x_2) \le {\lambda}f(x_1) + (1 - \lambda)f(x_2) 
\eqno{(1.2.2)} $$

\subsection*{$P_{19}$ 定理 1.2.4}
$f(x)$是凸函数的充要条件是：对于S中的任意一点$\bar{x}$，都有：
$$ 
f(x) \ge f(\bar{x}) + \nabla f(\bar{x})^T(x-\bar{x})
\eqno{(1.2.6)} $$

\subsection*{$P_{20}$ 定义 1.2.6}
凸规划问题是指最优化问题：
\begin{align*}
\tag{1.2.10}
\min \qquad & f_0(x), \ x \in R^n \\
\tag{1.2.11}
s.t. \qquad & f_i(x) \le 0, \ i = 1, \ldots , m \\
\tag{1.2.12}
& h_i(x) = {a_i^T}x - b_i = 0, \  i = 1, \ldots, p. 
\end{align*}
\quad 
其中$f_0(x)$和$f_i(x)$都是定义在$R^n$上的连续可微凸函数，而$h_i(x)$是线性函数。

\subsection*{$P_{20}$ 引理 1.2.8}
若$f(x)$是$R^n$上的凸函数，则对于任意的$c \in R$，水平集：
$$ S = \{x|f(x) \le c, x \in R^n\}
\eqno{(1.2.16)} $$
是凸集。

\subsection*{$P_{20}$ 定理 1.2.10}
考虑凸规划问题(1.2.10)$\to$(1.2.12)，若$x^*$是它的局部解，则$x^*$也是它的整体解。

\subsection*{$P_{21}$ 定理 1.2.12}
若凸规划问题(1.2.10)$\to$(1.2.12)中的目标函数$f_0(x)$是严格凸函数，则该问题的解唯一。

\subsection*{$P_{21}$ 定义 1.2.13}
设凸规划问题(1.2.10)$\to$(1.2.12)中变量$x$具有式：
$$ x = \left( \begin{array}{c} x_{1} \\
x_{2} \end{array} \right), 
\quad x_i \in R^{m_i}, 
\quad i = 1,2. 
\quad m_1 + m_2 = n.
\eqno{(1.2.22)} $$
所示的分划。称$x^*_1$是该问题关于$x_1$的解，如果存在$x^*_2 \in R^{m_2}$，使得$ x^* = ({x^*_1}^T, {x^*_2}^T)^T $是该问题的解。

\subsection*{$P_{22}$ 定理 1.2.15}
设凸规划问题(1.2.10)$\to$(1.2.12)中变量$x$具有式(1.2.22)的分划，记$f_0(x) = \mathbf{F}_0(x_1, x_2)$。若$\mathbf{F}_0(x_1, x_2)$分别是变量$x_1$和$x_2$的严格凸函数，则该问题对$x_1$的解唯一。

\section*{凸规划的对偶理论}

\subsection*{$P_{23}$ 定义 1.2.16 对偶问题}
引进Lagrange函数：
$$
\mathbf{L}(x, \lambda, \nu) = f_0(x) + \sum_{i = 1}^{m}{\lambda}_if_i(x) + \sum_{i = 1}^{p}{\nu}_ih_i(x)
\eqno{(1.2.35)} $$
其中$\lambda = ({\lambda}_1, \ldots, {\lambda}_m)^T$和$\nu = ({\nu}_1, \ldots, {\nu}_m)^T$是Lagrange乘子向量。
由书上$P_{23}$的论述可知，在$\lambda \ge 0$时：$$\inf_{x \in R^n}\mathbf{L}(x, \lambda, \nu)$$
是$f_0(x)$的下界。
对于要找到最好的下界的问题，我们把：
\begin{align*}
\tag{1.2.40}
\max \qquad & g(\lambda, \nu) = \inf_{x \in R^n}\mathbf{L}(x, \lambda, \nu) \\
\tag{1.2.41}
s.t. \qquad & \lambda \ge 0
\end{align*}

称(1.2.40)$\to$(1.2.41)为问题(1.2.10)$\to$(1.2.12)关于Lagrange函数(1.2.35)的对偶问题，或简称为问题(1.2.10)$\to$(1.2.12)的对偶问题。称(1.2.10)$\to$(1.2.12)为原始问题。

\subsection*{$P_{24}$ 定义 1.2.17 对偶间隙}
称原始问题的最优值与对偶问题的最优值之差为原始问题的对偶间隙。

\subsection*{$P_{24}$ 定理 1.2.18 弱对偶定理}
原始问题(1.2.10)$\to$(1.2.12)的对偶间隙永远取非负，即原始问题的最优值$p^*$和对偶问题(1.2.40)$\to$(1.2.41)的最优值$d^*$有如下关系：
\begin{align*}
p^* &= \inf\{f_0(x)\} \\
& \ge \sup\{g(\lambda, \nu)\} \\
\tag{1.2.43}
& = d^*
\end{align*}

上述定理有如下推论：
\subsection*{$P_{24}$ 推论 1.2.19}
设$\tilde{x}$和$(\tilde{\lambda}, \tilde{\nu})$分别是原始问题(1.2.10)$\to$(1.2.12)和对偶问题(1.2.40)$\to$(1.2.41)的可行解。若$f_0(\tilde{x}) = g(\tilde{\lambda}, \tilde{\nu})$，则$\tilde{x}$和$(\tilde{\lambda}, \tilde{\nu})$分别是原始问题和对偶问题的整体解。

\subsection*{$P_{24}$ 定理 1.2.20 Slater条件}
强对偶定理讨论的是对偶间隙为零的情况，我们需要“约束规格”来保证对偶间隙为零。对于凸规划问题(1.2.10)$\to$(1.2.12)，最简单的约束规格是满足Slater条件：如果存在可行点$x$，使得:
$$
f_i(x) < 0, \ i=1, \ldots, m; \ {a_i^T}x - b_i = 0, \  i = 1, \ldots, p
\eqno{(1.2.44)} $$
特别地，当凸规划问题的前$k$个不等式约束为线性约束：$f_i(x) = {a_i^T}x - b_i \le 0, \ i = 1, \ldots, k$时，条件可进一步宽松为书上(1.2.45)$\to$(1.2.46)。

\subsection*{$P_{25}$ 定理 1.2.21 强对偶定理}
对于凸规划问题(1.2.10)$\to$(1.2.12)，若它满足Slater条件，则它的对偶间隙为零。进一步，若还知原始问题的最优值可以达到，即存在最优解$x^*$，则对偶问题的最优值也可以达到，即存在对偶问题的整体解$({\lambda}^*, {\nu}^*)$使得：
\begin{align*}
f_0(x^*) &= \inf{f_0(x)} \\ 
&= \sup\{g({\lambda}, {\nu})|\lambda \le 0\} \\
&= \max\{g({\lambda}, {\nu})|\lambda \le 0\} \\
&= g({\lambda}^*, {\nu}^*)
\tag{1.2.47}
\end{align*}

\subsection*{$P_{25}$ 定义1.2.22 KKT条件}
考虑凸规划问题(1.2.10)$\to$(1.2.12)，称$x^*$满足KKT条件，如果存在分别于约束(1.2.11)和约束(1.2.12)对应的乘子向量${\lambda} = ({\lambda}^*_1, \ldots, {\lambda}^*_m)$和${\nu} = ({\nu}^*_1, \ldots, {\nu}^*_m)$使得Lagrange函数：
$$
\mathbf{L}(x, \lambda, \nu) = f_0(x) + \sum_{i = 1}^{m}{\lambda}_if_i(x) + \sum_{i = 1}^{p}{\nu}_ih_i(x)
\eqno{(1.2.48)} $$
满足：
\begin{align*}
\tag{1.2.49}
f_i(x^*) &\le 0, \qquad i=1, \ldots, m \\
\tag{1.2.50}
h_i(x^*) &= 0, \qquad i=1, \ldots, p \\
\tag{1.2.51}
{\lambda}_i^* &\ge 0, \qquad i=1, \ldots, m \\
\tag{1.2.52}
{\lambda}^*_i f_i(x^*) &= 0, \qquad i=1, \ldots, m \\
\tag{1.2.53}
\nabla_x \mathbf{L}(x^*, \lambda^*, \nu^*) &= \nabla f_0(x^*) + \sum_{i=1}^{m}\lambda^*_i \nabla f_i(x^*) + \sum_{i=1}^p \nu_i^* \nabla h_i(x^*) = 0
\end{align*}

\vspace{12mm}
利用强对偶定理可以证明KKT条件是凸规划解的必要条件：
\subsection*{$P_{25}$ 定理1.2.23 }
考虑凸规划问题(1.2.10)$\to$(1.2.12)，并设它满足Slater条件。若$x^*$是该问题的解，则$x^*$满足KKT条件。

\vspace{12mm}
下列定理表明KKT条件不仅是凸规划解的必要条件，而且也是充分条件。
\subsection*{$P_{26}$ 定理1.2.24 }
考虑凸规划问题(1.2.10)$\to$(1.2.12)，若$x^*$满足KKT条件，则$x^*$是该问题的解。

\vspace{12mm}
综合上面两个定理，有：
\subsection*{$P_{27}$ 定理1.2.25}
对于满足Slater条件的凸规划问题(1.2.10)$\to$(1.2.12)，点$x^*$是解的充分必要条件是它满足KKT条件。
\newpage

\subsection*{$P_{27}$ 线性规划问题}
\begin{align*}
\tag{1.2.57}
\min \qquad & c^Tx, \quad x \in \mathbf{R}^n \\
\tag{1.2.58}
s.t. \qquad & \bar{A}x - \bar{b} \le 0 \\
\tag{1.2.59}
& Ax - b = 0 \\
\end{align*}
线性问题对应的Lagrange函数应为：
$$
\mathbf{L}(x, \lambda, \nu) = c^T x + \lambda^T (\bar{A} x - \bar{b}) + \nu^T(Ax - b)
\eqno{(1.2.60)} $$

\subsection*{$P_{27}$ 定理1.2.26 }
线性规划问题(1.2.57)$\to$(1.2.59)的对偶问题是：
\begin{align*}
\tag{1.2.61}
\max \qquad & -\bar{b}^T\lambda - b^T \nu \\
\tag{1.2.62}
s.t. \qquad & \bar{A}^T\lambda + A^T \nu + c = 0 \\
\tag{1.2.63}
& \lambda \ge 0
\end{align*}

\section*{线性分类机}

\subsection*{$P_{56}$ 分类问题 }
给定训练集
$$
T = \{(x_1, y_1), \ldots, (x_i, y_i)\} \in (R^n \times \mathcal{Y})^l
\eqno{(2.1.5)} $$
其中$x_i \in R^n, y_i \in \mathcal{Y} = \{1, -1\}, i = 1, \ldots, l $，寻找$R^n$空间上的一个实值函数g(x)，以便用决策函数
$$
f(x) = sgn(g(x))
\eqno{(2.1.6)} $$
推断任意输入$x$对应的输出$y$。

\subsection*{$P_{57}$ 线性可分问题 }
略

\subsection*{$P_{59}$ 通过最大间隔法将分类问题转化为 }
\begin{align*}
\tag{2.2.3}
\max_{\omega, b} \qquad & \frac{2}{\| \omega \|} \\
\tag{2.2.4}
s.t. \qquad & \forall i \in \{i| y_i = 1\}: (\omega \cdot x_i) + b \ge 1 \\
\tag{2.2.5}
& \forall i \in \{i| y_i = -1\}: (\omega \cdot x_i) + b \le -1 \\
\end{align*}
或者：
\begin{align*}
\tag{2.2.8}
\min_{\omega, b} \qquad & \frac{1}{2}{\| \omega \|}^2 \\
\tag{2.2.9}
s.t. \qquad & y_i((\omega \cdot x_i) + b) \ge 1, \qquad i=1, \ldots, l \\
\end{align*}

\subsection*{$P_{62}$ 分类问题的对偶问题 }
通过求解(2.2.8)$\to$(2.2.9)的对偶问题而寻求它的解。引入Lagrange函数：
$$
\mathbf{L}(\omega, b, \alpha) = \frac{1}{2}{\| \omega \|}^2 + \sum_{i = 1}^{l}{\alpha}_i (y_i((\omega \cdot x_i) + b) - 1)
\eqno{(2.2.26)} $$
根据定义1.2.16给出的对偶问题应该为：
\begin{align*}
\tag{2.2.30}
\max \qquad & g(\alpha) = \inf_{\omega, b} \mathbf{L}(\omega, b, \alpha) \\
\tag{2.2.31}
s.t. \qquad & \alpha \ge 0
\end{align*}
由于$\mathbf{L}(\omega, b, \alpha)$是$\omega$的严格凸二次函数，它取最小值时：
$$
\nabla_\omega \mathbf{L}(\omega, b, \alpha) = \omega - \sum_{i=1}^l y_ix_i\alpha_i = 0
\eqno{(2.2.32)} $$
即
$$
\omega = \sum_{i=1}^l \alpha_i y_i x_i
\eqno{(2.2.33)} $$
代入式(2.2.26)：
$$
\inf_{\omega, b} \mathbf{L}(\omega, b, \alpha) = 
\left \{ \begin{array}{ll}
- \frac{1}{2} \sum\limits_{i=1}^{l} \sum\limits_{j=1}^{l} y_i y_j \alpha_i \alpha_j (x_i \cdot x_j) + \sum\limits_{j=1}^l \alpha_j, & when \sum\limits_{i=1}^l y_i \alpha_i = 0 \\
[5mm]
-\infty & else
\end{array}
\right.
\eqno{(2.2.35)} $$

故最优化问题：
\begin{align*}
\tag{2.2.27}
\max_\alpha \qquad & - \frac{1}{2} \sum_{i=1}^l \sum_{j=1}^l y_i y_j (x_i \cdot x_j) \alpha_i \alpha_j + \sum_{j=1}^l \alpha_j \\
\tag{2.2.28}
s.t. \qquad & \sum_{i=1}^l y_i \alpha_i = 0 \\
\tag{2.2.29}
\qquad & \alpha_i \ge 0, \quad i= 1, \ldots, l
\end{align*}
是原始问题(2.2.8)$\to$(2.2.9)的对偶问题。
在最优化方法的研究中常用等价的最小化问题取代最大化问题，这里也引进与上述问题有相同解集的最小化问题：
\begin{align*}
\tag{2.2.36}
\min_\alpha \qquad & \frac{1}{2} \sum_{i=1}^l \sum_{j=1}^l y_i y_j (x_i \cdot x_j) \alpha_i \alpha_j - \sum_{j=1}^l \alpha_j \\
\tag{2.2.37}
s.t. \qquad & \sum_{i=1}^l y_i \alpha_i = 0 \\
\tag{2.2.38}
\qquad & \alpha_i \ge 0, \quad i= 1, \ldots, l
\end{align*}

该问题的矩阵形式可以表示为：
\begin{align*}
\tag{2.2.40}
\min_\alpha & \qquad W(\alpha) = \frac{1}{2} \alpha^T H \alpha - e^T \alpha \\
\tag{2.2.41}
s.t. & \qquad \alpha^T y = 0 \\
\tag{2.2.42}
& \qquad \alpha \ge 0
\end{align*}
其中：
\begin{align*}
H &= (y_i y_j (x_i \cdot x_j))_{l \times l} \\
e &= (1, \ldots, 1)^T \\
\alpha &= (\alpha_1, \ldots, \alpha_l)^T \\
\tag{2.2.39}
y &= (y_1, \ldots, y_l)^T
\end{align*}
因为存在可逆矩阵$Q = (y_1x_1, \ldots, y_lx_l)$使得$H = Q^T Q$，所以$H$是半正定矩阵。
由于该问题满足Slater条件，由定理1.2.23知，对于问题的解$\alpha^*$来说，存在Lagrange乘子向量$\tilde{b^*}$和$s^*$满足：
$$ 
\mathbf{L}(\alpha, s, \tilde{b}) = W(\alpha) + s (-\alpha) + \tilde{b} (\alpha^T y)
$$
由KKT条件可以得出：
$$
{\alpha^*}^T y = 0, \qquad \alpha^* \ge 0 
\eqno{(2.2.47)} $$
$$
s^* \ge 0, \qquad {s^*}^T \alpha^* = 0
\eqno{(2.2.48)} $$
$$
H \alpha^* - e + \tilde{b^*} y - s^* = 0
\eqno{(2.2.49)} $$
由式(2.2.48)和(2.2.49)可知：
$$
H \alpha^* - e + \tilde{b^*} y \ge 0
\eqno{(2.2.50)} $$
令$\omega^* = \sum\limits_{i=1}^{l} \alpha_i^* y_i x_i$，则式(2.2.50)等价于：
$$
y_i((\omega^* \cdot x_i) + \tilde{b^*}) \ge 1, \qquad i=1, \ldots, l \\
\eqno{(2.2.51)} $$
这表明$(\omega^*, \tilde{b^*})$是原始问题(2.2.8)$\to$(2.2.9)的可行解。
更进一步，由(2.2.33)和(2.2.47)$\to$(2.2.49)可得：
\begin{align*}
\frac{1}{2} {\| \omega^* \|}^2 &= \frac{1}{2} {\alpha^*}^T H \alpha^* \\
&= \frac{1}{2} {\alpha^*}^T H \alpha^* - {\alpha^*}^T (H \alpha^* + \tilde{b^*} y - e - s^*) \\
&= -\frac{1}{2} {\alpha^*}^T H \alpha^* - \tilde{b^*}{\alpha^*}^T y + e^T \alpha^* + {s^*}^T \alpha^* \\
&= -\frac{1}{2} {\alpha^*}^T H \alpha^* - \tilde{b^*} \mathbf{0} + e^T \alpha^* + \mathbf{0} \\
&= -\frac{1}{2} {\alpha^*}^T H \alpha^* + e^T \alpha^*
\tag{2.2.52}
\end{align*}
因此，原始问题(2.2.8)$\to$(2.2.9)在$(\omega^*,\tilde{b^*})$点的目标函数值和对偶问题(2.2.40)$\to$(2.2.42)的最优值相同，根据推论1.2.19，$(\omega^*,\tilde{b^*})$为原始问题(2.2.8)$\to$(2.2.9)的最优解。对于解的唯一性和非零性，可以由最大间隔法的特性推到得出。

\subsection*{$P_{63}$ 定理 2.2.7 }
考虑线性可分问题，则对偶问题(2.2.27)$\to$(2.2.29)必有解$\alpha^* = (\alpha_1^*, \ldots, \alpha_l^*)^T$。

\subsection*{$P_{63}$ 定理 2.2.8 }
最优化问题(2.2.36)$\to$(2.2.38)是凸二次规划。

\subsection*{$P_{63}$ 定理 2.2.9 }
若$\alpha^* = (\alpha_1^*, \ldots, \alpha_l^*)^T$是问题(2.2.36)$\to$(2.2.38)的任意解，则原始问题(2.2.8)$\to$(2.2.9)的唯一解是：
\begin{align*}
\tag{2.2.43}
\omega^* &= \sum_{i=1}^l \alpha^*_i y_i x_i \\
\tag{2.2.44}
b^* &= y_j - \sum_{i=1}^l \alpha^*_i y_i (x_i \cdot x_j)
\end{align*}
或者
\begin{align*}
\tag{2.2.45}
\omega^* &= \sum_{i=1}^l \alpha^*_i y_i x_i \\
\tag{2.2.46}
b^* &= - \frac{\left( \omega^* \cdot \sum\limits_{i=1}^{l} \alpha_i^* x_i \right)}{2 \sum\limits_{y_i=1}\alpha_i^*}
\end{align*}

对于表达式(2.2.47)和(2.2.46)的证明：因为$\alpha^* \ne 0$，所以存在下标j，使得$\alpha^*_j > 0$。由条件(2.2.47)$\to$(2.2.49)知，若$\alpha^*_j > 0$则$s^*_j = 0$，因此知道$H \alpha^* - e + \tilde{b^*}y$的第j个分量等于0.由此等式解出$\tilde{b^*}$，便得式(2.2.44)。另外，由式(2.2.47)中的第二式和式(2.2.48)可知，对$i = 1, \ldots, l.$有$s^*_i \alpha^*_i = 0.$而由式(2.2.49)得：
$$
s^*_i = y_i (( \omega^* \cdot x_i) + \tilde{b^*}) - 1, \qquad i = 1, \ldots l.
\eqno{(2.2.53)} $$
所以
$$
s^*_i \alpha_i^* = \alpha_i^* (y_i (( \omega^* \cdot x_i) + \tilde{b^*}) - 1) = 0, \qquad i = 1, \ldots l.
\eqno{(2.2.54)} $$
进一步

\subsection*{$P_{65}$ 算法 2.2.10 线性可分支持向量分类机}
\subsubsection*{(1)}
给定训练集合$T = \{(x_1, y_1), \ldots, (x_i, y_i)\} \in (R^n \times \mathcal{Y})^l$ 
\subsubsection*{(2)}
构造并求解凸二次规划问题：
\begin{align*}
\tag{2.2.57}
\min_\alpha \qquad & \frac{1}{2} \sum_{i=1}^l \sum_{j=1}^l y_i y_j (x_i \cdot x_j) \alpha_i \alpha_j - \sum_{j=1}^l \alpha_j \\
\tag{2.2.58}
s.t. \qquad & \sum_{i=1}^l y_i \alpha_i = 0 \\
\tag{2.2.59}
\qquad & \alpha_i \ge 0, \quad i= 1, \ldots, l
\end{align*}
得到解$\alpha^* = (\alpha_1^*, \ldots, \alpha_l^*)^T$
\subsubsection*{(3)}
计算$ \omega^* = \sum_{i=1}^l \alpha^*_i y_i x_i $，选取$\alpha^*$的一个正分量$\alpha_j^*$，据此计算：
$$
b^* = y_j - \sum_{i=1}^l \alpha^*_i y_i (x_i \cdot x_j)
\eqno{(2.2.60)} $$
\subsubsection*{(4)}
构造分划超平面$ (\omega* \cdot x) + b^* = 0$，由此求得决策函数：
$$
f(x) = sgn(g(x))
\eqno{(2.2.61)} $$
其中，
$$
g(x) = (\omega* \cdot x) + b^* = \sum_{i=1}^l y_i \alpha_i^* (x_i \cdot x) + b^*
\eqno{(2.2.62)} $$

\end{document}
